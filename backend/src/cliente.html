<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Test Socket.io</title>
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
</head>
<body>
  <h2>🛰️ Escuchando eventos de aprobación/rechazo de crédito...</h2>
  <pre id="log"></pre>

  <script>
    const log = (msg, data) => {
      const text = data ? `${msg}: ${JSON.stringify(data, null, 2)}` : msg;
      document.getElementById("log").textContent += text + "\n";
      console.log(msg, data || '');
    };

    const socket = io("http://localhost:3001", {
      transports: ["websocket"], // evita polling
      reconnection: true,
    });

    socket.on("connect", () => log("✅ Conectado al servidor con ID", socket.id));
    socket.on("disconnect", (reason) => log("⚠️ Desconectado", reason));
    socket.on("connect_error", (err) => log("🚨 Error de conexión", err.message));

    socket.on("aprobacionCredito", (data) => log("🎉 Evento recibido: aprobacionCredito", data));
    socket.on("rechazoCredito", (data) => log("❌ Evento recibido: rechazoCredito", data));
  </script>
</body>
</html>
